---
layout: post
title: PowerShell Profile Tips & Tricks
date: '2014-10-21T11:52:00.001-04:00'
author: Damien Solodow
tags:
- PowerShell
- IndyPoSH
modified_time: '2014-10-21T12:05:46.502-04:00'
blogger_id: tag:blogger.com,1999:blog-23185081170317196.post-8761384466274846516
blogger_orig_url: http://theevolvingadmin.blogspot.com/2014/10/powershell-profile-tips-tricks.html
---

<span xmlns=""></span><br /><div style="text-align: center;"></div><h1><span xmlns="">What is it?</span></h1><br /><span xmlns="">A PowerShell profile is just a normal PowerShell script with a specific name and location. This means it's subject to your current ExecutionPolicy, so you'll either need to sign your profile or use RemoteSigned.</span><br /><span xmlns="">It's a similar concept as say autoexec.bat or .bashrc; when you launch the PowerShell console, or open a new tab in the ISE, the host process looks for and executes the applicable profile.</span><br /><span xmlns="">There are multiple possible profiles, and you <strong>can</strong> have several of them, although I prefer (and suggest) not doing so unless you have an overriding need as it makes it more complicated. </span><br /><span xmlns="">The Scripting Guy has an excellent <a href="http://blogs.technet.com/b/heyscriptingguy/archive/2013/01/04/understanding-and-using-powershell-profiles.aspx">post</a> that explains in excellent detail, but here's the short version:</span><br /><ul><li><span xmlns="">There is a <strong>CurrentUser</strong> set of profiles which live in your Documents\WindowsPowerShell folder</span></li><li><span xmlns="">There is a <strong>AllUsers</strong> set of profiles which live in $PSHOME</span></li><li><span xmlns="">Each set can have an <strong>AllHosts</strong> profile, as well as a host specific profile for each host (generally console and ISE)</span></li><li><span xmlns="">If you have multiple profiles, the most specific one runs last (and thus "wins")</span></li><li><span xmlns="">None of the profiles exist by default, they have to be created.</span></li><li><span xmlns="">The profile scripts do <strong>not</strong> get invoked automatically by remote session.</span></li></ul><span xmlns="">There is a built-in variable ($profile) that makes life easier. Here's a command to show you where the profiles would live: <span style="color: #0070c0;">$profile | get-member â€“membertype noteproperty</span><br />   </span><br /><div style="text-align: center;"></div><h1><span xmlns="">What good is it?</span></h1><br /><span xmlns="">Here's the real meat of the story. <span style="font-family: Wingdings;">J</span><br />   </span><br /><span xmlns="">Since the profiles are standard PowerShell scripts, anything you can do in a PowerShell script can be in your profile. Just remember though, that the profile scripts run <strong>every</strong> time you launch PowerShell, so you don't want them to take a long time to run. You also do <strong>not </strong>want them to require any user input as PowerShell won't finish loading until that input is provided. This is especially painful if you have PowerShell logon/logoff or start/shutdown script defined in your GPOs.</span><br /><span xmlns="">Anything you find yourself running/typing <strong>every</strong> time you launch the console or ISE should probably go in your profile.</span><br /><div style="text-align: center;"></div><h3><span xmlns="">The most common and useful things to put in your profile are:</span></h3><br /><ul><li><span xmlns="">Functions (<span style="color: #0070c0;">help about_Functions</span>)</span></li><li><span xmlns="">Aliases (<span style="color: #0070c0;">help about_Aliases</span>)</span></li><li><span xmlns="">PSDrives (<span style="color: #0070c0;">help About_Providers</span>)</span></li><li><span xmlns="">PSDefaultParameterValues (<span style="color: #0070c0;">help about_Parameters_Default_Values</span>)</span></li></ul><span xmlns="">My profile started out originally because I didn't want to have to launch each of the different, separate, PowerShell "consoles" that each snap-in or tool seemed to create. After all, why go launch <a href="http://www.vmware.com/go/PowerCLI">PowerCLI</a> or Exchange Management Shell when I can just create a function in my profile that adds those things to my current session?</span><br /><span xmlns="">Another very useful case are modules/snap-ins that have to be run from a server with a specific role such as XenApp or SharePoint. The SharePoint PowerShell snap-in has to be run from a SharePoint server that is part of the farm you're working with. So rather than have to create a new session each time you want to access it (or worse RDP to the server to run PowerShell!) I've created a function that uses <a href="http://blogs.technet.com/b/heyscriptingguy/archive/2013/09/08/remoting-the-implicit-way.aspx"><em>implicit remoting</em></a> to import the snap-in. </span><br /><span xmlns="">I've posted a generalized and heavily commented version of my own profile script on GitHub: <a href="https://github.com/dsolodow/IndyPoSH/blob/master/Profile.ps1">https://github.com/dsolodow/IndyPoSH/blob/master/Profile.ps1</a><br />   </span><br /><span xmlns="">Feel free to read through it, post questions or comments in the Issues or Discussion pages for the project. Also feel free to borrow snippets or sections out of it that you want to use for yourself.  </span><br /><div style="text-align: center;"></div><h3><span xmlns="">Other ideas:</span>&nbsp;</h3><span xmlns="">The Scripting Guy has a series of posts about "What's in your profile" with information from various PFEs, PowerShell MVPs, members of the PowerShell team, etc. Links below.</span><br /><span xmlns="">What's in your profile (PFEs):&nbsp;<a href="http://bit.ly/1BxOImo">http://bit.ly/1BxOImo</a><br />   </span><br /><span xmlns="">What's in your profile (PowerShell team):&nbsp;<a href="http://bit.ly/1rGAzm4">http://bit.ly/1rGAzm4</a><br />   </span><br /><span xmlns="">What's in your profile (MVPs):&nbsp;<a href="http://bit.ly/1vrjqxJ">http://bit.ly/1vrjqxJ</a><br />   </span><br /><span xmlns="">What's in your profile (User favorites Part 1):&nbsp;<a href="http://bit.ly/1mIUOyV">http://bit.ly/1mIUOyV</a><br />   </span><br /><span xmlns="">What's in your profile (User favorites Part 2):&nbsp;<a href="http://bit.ly/1qPP7uf">http://bit.ly/1qPP7uf</a><br />   </span><br /><span xmlns="">What's in your profile (Scripting Guy):&nbsp;<a href="http://bit.ly/1uxMdlt">http://bit.ly/1uxMdlt</a><br />   </span><br /><div style="text-align: center;"></div><h1><span xmlns="">Any rules, best practices, no-nos?</span>&nbsp;</h1><span xmlns="">There aren't a lot of hard, fast rules but here are the ones I know of as well as some good practices/suggestions:</span><br /><ul><li><span xmlns=""><span style="color: #c00000;">Don't make your profiles require user input</span><br />    </span></li><li><span xmlns=""><span style="color: #c45911;">Be careful about system/version dependent features/cmdlets</span></span></li><li><span xmlns=""><span style="color: #c45911;">Make sure you either sign your script or run PowerShell with the <strong>RemoteSigned</strong> executionPolicy</span></span></li><li><span xmlns=""><span style="color: #c00000;">Don't make your profile script something that takes a long time to run as you'll run it a lot</span></span></li><li><span xmlns=""><em>It's a PowerShell script, treat it accordingly. This means comment it, format it appropriately, put it in version control, etc.</em><br />     <a href="http://windowsitpro.com/blog/my-12-powershell-best-practices">http://windowsitpro.com/blog/my-12-powershell-best-practices</a><br />    </span></li><li><span xmlns=""><span style="color: #00b050;">Do share cool tricks or ideas with your co-workers, fellow IndyPosh members, the PowerShell community</span></span></li><li><span xmlns=""><span style="color: #00b050;">Let your profile grow organically; when in doubt K.I.S.S.</span></span></li><li><span xmlns=""><span style="color: #00b050;">Remember: help about_profiles</span></span></li></ul>